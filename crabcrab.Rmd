---
title: "Crab Research Proj"
output:
  html_document:
    df_print: paged
---

### Team:
- Alina Muliak
- Olexiy Hoiev
- Oleksandra Stasiuk


```{r}
library(ggplot2)
```

```{r}
data <- read.csv("./CrabAgePrediction.csv", TRUE)

data <- data[,-6:-8]
data <- data[order(data$Age),]
data$Length[1:100]
plot(data, col="purple")
plot(data$Height, col="purple")
```

```{r}
ggplot(data) +
    geom_density(aes(x = Length, fill = Sex), alpha = 0.5) +
    labs(y = "Density", x = "Length", fill = "Nitrogen\nConcentration") +
    scale_fill_manual(labels = c("M", "F", "I"),
        values = c("#DB24BC", "#BCDB24", "#24BCDB")) +
    theme_minimal()
ggplot(data) +
    geom_density(aes(x = Age, fill = Sex), alpha = 0.6) +
    labs(y = "Density", x = "Age", fill = "Nitrogen\nConcentration") +
    scale_fill_manual(labels = c("M", "F", "I"),
        values = c("#DB24BC", "#BCDB24", "#24BCDB")) +
    theme_minimal()
head(data)
```

```{r}
mydata <- read.csv("./CrabAgePrediction.csv", TRUE)
summary(mydata)
```
The good measure to test how good is our model is the **coefficient of determination** $R^2$. This measure is defined by the proportion of the total variability explained by the regression model.
$$R^2 = \frac{\text{Explained variation of the model}}{\text{Total variation of the model}}$$
We know, that for models that fit the data well, $R^2$ is near $1$ and conversely, models that poorly fit the data have $R^2$ near $0$.
```{r}
height <- lm(Age ~ Height, data = mydata)
summary(height)
```
Here we can see that this model has an $R^2$ of $0.3$; this means that the model explains only $30\%$ of the data variability, which is not the desired and satisfactory result for us. So, probably `Height` does not tell much about crab's age.
